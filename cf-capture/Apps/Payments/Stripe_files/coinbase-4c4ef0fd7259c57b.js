try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="d6805bc6-c9d2-49d5-908d-372dbef41e48",e._sentryDebugIdIdentifier="sentry-dbid-d6805bc6-c9d2-49d5-908d-372dbef41e48")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2855],{48862:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[orgId]/gateways/coinbase",function(){return t(54005)}])},30853:function(e,n,t){"use strict";t.d(n,{Z:function(){return P}});var r=t(31791),a=t(70813),i=t(22188),s=t(93133),o=t(16637),c=t(55826);let l=c.forwardRef(function({title:e,titleId:n,...t},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 33 32",style:{flexShrink:0,display:"inline-block"},"aria-hidden":"true","data-slot":"icon",height:24,width:24,ref:r,"aria-labelledby":n},t),e?c.createElement("title",{id:n},e):null,c.createElement("circle",{cx:16.25,cy:16,r:16,fill:"#7451D8",fillOpacity:.15}),c.createElement("circle",{cx:16.25,cy:16,r:8,fill:"#7451D8"}),c.createElement("path",{stroke:"white",strokeLinejoin:"round",strokeWidth:.9,d:"M16.25 12.8181V15.9999H19.4318"}),c.createElement("path",{stroke:"white",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:.9,d:"M16.25 21C19.0114 21 21.25 18.7614 21.25 16C21.25 13.2386 19.0114 11 16.25 11C13.4886 11 11.25 13.2386 11.25 16C11.25 18.7614 13.4886 21 16.25 21Z"}))});var d=t(20838),u=t(50288),h=t(68437);function g(){let e=(0,r._)(["\n  0% {\n    transform: scale(0.99);\n    box-shadow: 0 0 0 0 ",";\n  }\n\n  70% {\n    transform: scale(1);\n    box-shadow: 0 0 0 8px rgba(0, 0, 0, 0);\n  }\n\n  100% {\n    transform: scale(0.95);\n    box-shadow: 0 0 0 0 rgba(0, 0, 0, 0);\n  }\n"]);return g=function(){return e},e}function m(){let e=(0,r._)(["\n  width: ",";\n  height: ",";\n  animation: "," 2s infinite;\n  background: rgba(6, 112, 247, 0.4);\n  border-radius: 50%;\n"]);return m=function(){return e},e}function f(){let e=(0,r._)(["\n  display: flex;\n  align-items: center;\n  border-radius: 50%;\n  transform: scale(1);\n  width: ",";\n  animation: "," 2s infinite;\n"]);return f=function(){return e},e}function x(){let e=(0,r._)(["\n    height: 3.2rem;\n    width: 3.2rem;\n  "]);return x=function(){return e},e}function b(){let e=(0,r._)(["\n    height: 2.6rem;\n    width: 2.6rem;\n  "]);return b=function(){return e},e}function p(){let e=(0,r._)(["\n  display: flex;\n  align-items: center;\n  border-radius: ",";\n  ",";\n"]);return p=function(){return e},e}let y={warning:{icon:(0,a.jsx)(i.Z,{}),rgba:"rgba(247, 180, 34, 0.5)"},info:{icon:(0,a.jsx)(s.Z,{}),rgba:"rgba(6, 112, 247, 0.5)"},success:{icon:(0,a.jsx)(o.Z,{}),rgba:"rgba(38, 138, 90, 0.5)"},clock:{icon:(0,a.jsx)(l,{}),rgba:"rgba(116, 81, 216, 0.5)"},error:{icon:(0,a.jsx)(d.Z,{}),rgba:"rgba(255, 97, 87, 0.5)"}},v=e=>(0,u.F4)(g(),e),j=u.zo.div(m(),e=>{let{size:n}=e;return"sm"===n?"1.5rem":"3rem"},e=>{let{size:n}=e;return"sm"===n?"1.5rem":"3rem"},v("rgba(6, 112, 247, .8)")),w=u.zo.div(f(),e=>{let{size:n}=e;return"sm"===n?"2.6rem":"3.2rem"},e=>{let{rgba:n}=e;return v(n)}),k={md:(0,u.iv)(x()),sm:(0,u.iv)(b())},C=u.zo.div(p(),h.Q2.radii.full,e=>{let{size:n}=e;return k[n]});var P=e=>{let{variant:n="empty",size:t="sm",className:r}=e;return"empty"===n?(0,a.jsx)(j,{className:r,size:t}):(0,a.jsx)(w,{rgba:y[n].rgba,className:r,size:t,children:(0,a.jsx)(C,{size:t,children:y[n].icon})})}},47541:function(e,n,t){"use strict";t.d(n,{Z:function(){return s}});var r=t(38220),a=t(33618),i=t(55826);function s(){let{errorMessage:e,message:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,r.pm)();return(0,i.useCallback)(async r=>{try{await navigator.clipboard.writeText(r),t({message:n||"Successfully copied.",variant:"success"})}catch(n){if(n instanceof DOMException&&"NotAllowedError"===n.name){t({message:"Clipboard access denied. Please copy manually.",variant:"error"});return}t({message:e||(0,a.T)(n)||"Couldn't copy to clipboard.",variant:"error"})}},[e,n,t])}},88672:function(e,n,t){"use strict";t.d(n,{B:function(){return o},c:function(){return l}});var r=t(33618),a=t(6491),i=t(94216);let s=async(e,n)=>{if(n)try{return await i.w.validateCoinbaseApiKey(e,{apiKey:n}),!0}catch(e){}return!1},o=a.z.coerce.number({invalid_type_error:"Tolerance Percentage must be a number.",required_error:"Tolerance Percentage is required."}).int("Tolerance Percentage must be integer.").positive("Tolerance Percentage must be positive number.").min(0,"Tolerance Percentage must be greater than or equal to 0.").max(100,"Tolerance Percentage must be less than or equal to 100."),c=e=>a.z.string().trim().min(1,r.p8.Required).uuid("The API key must be in UUID format.").refine(n=>s(e,n),{message:"Invalid API key."}),l=e=>a.z.object({apiKey:a.z.custom(n=>n?c(e).describe("API Key"):a.z.any().optional()),tolerancePercentage:o})},223:function(e,n,t){"use strict";var r=t(70813),a=t(93133),i=t(38220),s=t(1222);n.Z=()=>(0,r.jsxs)(i.J2.Root,{children:[(0,r.jsx)(i.J2.Trigger,{asChild:!0,children:(0,r.jsx)(s.Z,{})}),(0,r.jsxs)(i.J2.Content,{size:"md",children:[(0,r.jsx)(i.J2.Title,{icon:(0,r.jsx)(a.Z,{}),children:"Tolerance Percentage"}),(0,r.jsxs)(i.J2.Description,{children:["Set a Tolerance Percent to allow transactions to change volume within certain tolerances. For each transaction, you can reduce the value by a percentage smaller than the percentage tolerance. You can enter zero to prevent transactions from reducing a budget.",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"Example: "}),"if the tolerance percentage is 10% and the initial value is $100, then if the transaction amount is more than $90, it will be confirmed, otherwise it will be rejected."]})]})]})},80362:function(e,n,t){"use strict";var r=t(70813),a=t(38220),i=t(30853);n.Z=()=>(0,r.jsx)(a.Uo,{children:(0,r.jsx)(a.bZ,{icon:(0,r.jsx)(i.Z,{variant:"warning"}),variant:"warning",children:"Warning! Such a high Tolerance Percentage can reduce the transaction value by at least 51%."})})},40050:function(e,n,t){"use strict";t.d(n,{w:function(){return s}});var r=t(55826),a=t(26360),i=t(12353);let s=()=>{let e=(0,i.X6)();return(0,r.useMemo)(()=>"".concat(a.O.NEXT_PUBLIC_API_URL,"/v1/webhooks/organizations/").concat(e,"/coinbase"),[e])}},24088:function(e,n,t){"use strict";t.d(n,{Z:function(){return c}});var r=t(31552),a=t(38220),i=t(93963),s=t(94216),o=t(12353);function c(){let e=(0,o.X6)(),n=(0,a.pm)();return(0,i.D)({mutationFn:n=>s.w.testCoinbaseWebhook(e,n),meta:{errorToast:!1},onError:e=>{if(e instanceof r.MS)switch(e.status){case 401:n({message:"Coinbase credentials incorrect",title:"Connection failed",variant:"error"});return;case 404:n({message:"Organization not found in Coinbase. Make sure you've copied and pasted the link correctly and then try again.",title:"Connection failed",variant:"error"});return;case 412:n({message:"Required conditions not met. Check if merchant has settlement or home address set.",title:"Connection failed",variant:"error"});return}n({title:"Connection failed",message:e.message,variant:"error"})},onSuccess:e=>{let{data:t}=e,{result:r}=t.data;if("OK"===r){n({message:"Coinbase gateway is working properly.",variant:"success",title:"Success"});return}n({message:"Make sure you've copied and pasted the link correctly and then try again.",title:"Connection failed",variant:"error"})}})}},54005:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return D}});var r=t(70813),a=t(38220),i=t(53164),s=t(26291),o=t(37013),c=t(40050),l=t(31791),d=t(18159),u=t(29283),h=t(56769),g=t(68437),m=t(55826),f=t(44065),x=t(50288),b=t(91084),p=t(47541),y=t(83160),v=t(16053),j=t(12353),w=t(88672),k=t(223),C=t(80362),P=t(24088);function Z(){let e=(0,l._)(["\n  input {\n    background: ",";\n    border: unset;\n  }\n"]);return Z=function(){return e},e}let T=(0,x.zo)(a.UP)(Z(),g.Q2.colors.ghostWhite);function _(e){var n,t,i,s;let{tolerancePercentage:o,apiKeyLastFour:l,onCancel:g}=e,x=(0,p.Z)({message:"The URL was successfully copied."}),Z=(0,v.Z)("coinbase"),[_,z]=(0,m.useState)(!1),I=(0,c.w)(),E=(0,P.Z)(),K=(0,j.X6)(),U=(0,a.pm)(),{formState:{isDirty:Q,errors:S,isSubmitSuccessful:L},handleSubmit:D,resetField:R,getValues:A,register:M,setValue:O,watch:F,reset:N}=(0,f.cI)({resolver:(0,d.F)((0,w.c)(K)),defaultValues:{tolerancePercentage:o},mode:"onTouched"}),{openUnsavedAlertDialog:V,UnsavedAlert:W}=(0,y.Q)({onDiscard:()=>{N(),g()},shouldConfirmLeave:Q&&!L}),q=F("tolerancePercentage")>=50,X=e=>{Z.mutate({...e.apiKey&&{apiKey:e.apiKey},tolerancePercentage:e.tolerancePercentage},{onSuccess:()=>{g(),U({message:"Connection details successfully updated",variant:"success"})}})},B=(e,n)=>{E.mutate(e,{onSuccess(e){"OK"===e.data.data.result&&X(n)}})};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("form",{onSubmit:D(e=>{let n=A("apiKey");n?B(n,e):X(e)}),children:[(0,r.jsxs)(a.kC,{alignItems:"flex-start",gridGap:"xs",children:[(0,r.jsx)(a.UP,{...M("apiKey"),placeholder:_?"":"••••".concat(l),errorMessage:null==S?void 0:null===(n=S.apiKey)||void 0===n?void 0:n.message,disabled:!_,label:"API Key",id:"apiKey"}),(0,r.jsx)(a.hU,{onClick:()=>{z(!0),R("apiKey"),O("apiKey","",{shouldValidate:!0,shouldDirty:!0})},"aria-label":"Reset API key",variant:"secondary",type:"button",size:"lg",mt:"xl",children:(0,r.jsx)(u.Z,{})})]}),(0,r.jsx)(a.UP,{...M("tolerancePercentage"),label:(0,r.jsxs)(r.Fragment,{children:["Tolerance Percentage ",(0,r.jsx)(k.Z,{})]}),errorMessage:null===(t=S.tolerancePercentage)||void 0===t?void 0:t.message,description:"From 0 to 100%",rightIcon:(0,r.jsx)(a.xv,{children:"%"}),id:"tolerancePercentage",type:"number",max:100,min:0}),q&&(0,r.jsx)(C.Z,{}),(0,r.jsxs)(a.kC,{alignItems:"flex-start",gridGap:"xs",children:[(0,r.jsx)(T,{label:"Webhook URL",value:I,readOnly:!0}),(0,r.jsxs)(a.u.Root,{children:[(0,r.jsx)(a.u.Trigger,{children:(0,r.jsx)("span",{children:(0,r.jsx)(a.hU,{onClick:()=>x(I),"aria-label":"Copy to clipboard",variant:"secondary",type:"button",size:"lg",mt:"xl",children:(0,r.jsx)(h.Z,{})})})}),(0,r.jsx)(a.u.Content,{children:"Copy to clipboard"})]})]}),(null===(i=E.data)||void 0===i?void 0:i.data.data.result)==="timeout"&&(0,r.jsxs)(a.fm,{children:["Make sure you've copied and pasted the link correctly and then try again. If the problem reoccurs, please"," ",(0,r.jsx)(a.ee,{href:"mailto:".concat(b.Z),children:(0,r.jsx)("strong",{children:"contact our support"})}),"."]}),E.isPending&&(0,r.jsx)(a.xu,{pb:"md",children:(0,r.jsx)(a.Uo,{children:(0,r.jsx)(a.bZ,{variant:"warning",children:"Testing the endpoint connection can take up to 60 seconds."})})}),(0,r.jsxs)(a.QQ.ContentAction,{children:[(0,r.jsx)(a.zx,{disabled:Z.isPending||E.isPending,onClick:V,variant:"secondary",type:"button",size:"md",children:"Cancel"}),(0,r.jsx)(a.zx,{$loading:Z.isPending,disabled:E.isPending,variant:"primary",type:"submit",size:"md",children:E.isPending?"Testing endpoint":(null===(s=E.data)||void 0===s?void 0:s.data.data.result)==="timeout"?"Try again":Z.isPending?"Saving":"Save"})]})]}),(0,r.jsx)(W,{})]})}function z(e){let{tolerancePercentage:n,apiKeyLastFour:t}=e,[i,l]=(0,s.Z)(!1),d=(0,c.w)(),{hasAccess:u}=(0,o.Z)();return(0,r.jsxs)(a.QQ.Root,{children:[(0,r.jsxs)(a.QQ.Header,{children:[(0,r.jsx)(a.QQ.Title,{children:"Connection details"}),(0,r.jsx)(a.QQ.HeaderAction,{children:!i&&u&&(0,r.jsx)(a.zx,{onClick:l,variant:"secondary",size:"lg",children:"Edit"})})]}),(0,r.jsxs)(a.QQ.Content,{children:[i&&(0,r.jsx)(a.Uo,{children:(0,r.jsx)(_,{tolerancePercentage:n,onCancel:()=>l(!1),apiKeyLastFour:t})}),!i&&(0,r.jsx)(a.Uo,{children:(0,r.jsxs)(a.uG,{children:[(0,r.jsx)(a.xv,{color:"waterloo",children:"API Key"}),(0,r.jsxs)(a.xv,{children:["••••",t]}),(0,r.jsx)(a.xv,{color:"waterloo",children:"Tolerance Percentage"}),(0,r.jsxs)(a.xv,{children:[n,"%"]}),(0,r.jsx)(a.xv,{color:"waterloo",children:"Webhook URL"}),(0,r.jsx)(a.xv,{wordBreak:"break-all",children:d})]})})]})]})}var I=t(74115),E=t(91449),K=t(85493),U=t(18208),Q=t(24714),S=t(75251);let L=()=>{let e="coinbase",{data:n,isPending:t,isError:i}=(0,I.Z)(e);return((0,S.Z)(n,t),t)?(0,r.jsx)(a.Ib,{loading:!0}):i?(0,r.jsx)(a.xu,{width:"fit-content",m:"sm",children:(0,r.jsx)(a.Te,{resource:"gateway"})}):(0,r.jsxs)(K.Z,{leftColumnContent:(0,r.jsx)(E.Z,{slug:e}),gateway:n,children:[(0,r.jsx)(z,{tolerancePercentage:null==n?void 0:n.tolerancePercentage,apiKeyLastFour:null==n?void 0:n.apiKeyLastFour}),(0,r.jsx)(U.Z,{gateway:n}),(0,r.jsx)(Q.Z,{gateway:n})]})};L.getLayout=e=>(0,r.jsx)(i.Z,{children:e});var D=L},56769:function(e,n,t){"use strict";var r=t(55826);let a=r.forwardRef(function({title:e,titleId:n,...t},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 17 16",style:{flexShrink:0,display:"inline-block"},"aria-hidden":"true",fill:"currentColor","data-slot":"icon",height:16,width:16,ref:a,"aria-labelledby":n},t),e?r.createElement("title",{id:n},e):null,r.createElement("path",{d:"M10.975.667h-8c-.733 0-1.333.6-1.333 1.333v9.333h1.333V2h8zm2 2.666H5.642c-.733 0-1.333.6-1.333 1.334V14c0 .733.6 1.333 1.333 1.333h7.333c.734 0 1.334-.6 1.334-1.333V4.667c0-.734-.6-1.334-1.334-1.334m0 10.667H5.642V4.667h7.333z"}))});n.Z=a}},function(e){e.O(0,[6843,3993,2627,5953,8159,7382,9855,3164,3099,4571,626,2756,2403,2888,9774,179],function(){return e(e.s=48862)}),_N_E=e.O()}]);