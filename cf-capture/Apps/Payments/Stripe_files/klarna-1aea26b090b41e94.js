try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="3c78bc43-b00f-4c1e-9bfa-eda3cd8bae65",e._sentryDebugIdIdentifier="sentry-dbid-3c78bc43-b00f-4c1e-9bfa-eda3cd8bae65")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9469],{95952:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[orgId]/gateways/klarna",function(){return r(99863)}])},16016:function(e,n,r){"use strict";var s=r(33618),t=r(6491);let a=t.z.custom(e=>void 0===e?t.z.string().safeParse(e).success:t.z.string().trim().min(1,s.p8.Required).safeParse(e).success),i=t.z.object({apiUsername:a,apiPassword:a,region:a});n.Z=i},94872:function(e,n,r){"use strict";r.d(n,{Z:function(){return i}});var s=r(93963),t=r(94216),a=r(12353);function i(){let e=(0,a.X6)();return(0,s.D)({mutationFn:async n=>t.w.validateKlarnaCredentials(e,n),meta:{errorToast:!1}})}},23597:function(e,n,r){"use strict";r.d(n,{Q:function(){return s}});let s=Object.entries(r(31552).cE).map(e=>{let[n,r]=e;return{value:n,label:r}})},91573:function(e,n,r){"use strict";var s=r(70813),t=r(38220);n.Z=e=>{let{currencies:n}=e;return(0,s.jsx)(t.kC,{flexWrap:"wrap",gridGap:"xxs",children:n.map(e=>(0,s.jsx)(t.Ct,{variant:"ongoing",children:e},e))})}},81244:function(e,n,r){"use strict";r.d(n,{Z:function(){return w}});var s=r(70813),t=r(38220),a=r(55826),i=r(37013),c=r(91573);function o(e){let{gateway:n}=e;return(0,s.jsxs)(t.uG,{children:[(0,s.jsx)(t.xv,{color:"waterloo",children:"Gateway currencies"}),(0,s.jsx)(c.Z,{currencies:n.currencies})]})}var l=r(18159),u=r(33618),d=r(44065),f=r(3997),x=r(16348),g=r(12630),j=r(6491),h=r(83160),m=r(16053),v=r(93181);let p=j.z.object({currencies:j.z.array(j.z.string().trim().min(1,u.p8.Required))});function b(e){let{closeForm:n,gateway:r}=e,{mutate:a,isPending:i}=(0,m.Z)(r.gateway.slug),c=(0,t.pm)(),{formState:{isDirty:o,isSubmitSuccessful:j},handleSubmit:b,control:w,reset:y}=(0,d.cI)({defaultValues:{currencies:r.currencies},resolver:(0,l.F)(p),mode:"onTouched"}),C=f.a(r.gateway.supportedCurrencies||[u.NE.USD],x.a(e=>({value:e,label:e})),g.a(e=>e.label)),{openUnsavedAlertDialog:Q,UnsavedAlert:Z}=(0,h.Q)({onDiscard:()=>{n(),y()},shouldConfirmLeave:o&&!j}),P=b(e=>{a({currencies:e.currencies},{onSuccess:()=>{n(),c({message:"Currencies for gateway ".concat(v.Z[r.gateway.slug]," saved successfully"),variant:"success"})}})});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("form",{onSubmit:P,children:[(0,s.jsx)(d.Qr,{render:e=>{let{field:n}=e;return(0,s.jsx)(t.If,{options:C,onChange:n.onChange,value:n.value,label:"Currencies"})},name:"currencies",control:w}),(0,s.jsxs)(t.QQ.ContentAction,{children:[(0,s.jsx)(t.zx,{onClick:Q,disabled:i,variant:"secondary",type:"button",size:"md",children:"Cancel"}),(0,s.jsx)(t.zx,{$loading:i,variant:"primary",type:"submit",size:"md",ml:"sm",children:"Save"})]})]}),(0,s.jsx)(Z,{})]})}function w(e){let{gateway:n}=e,[r,c]=(0,a.useState)(!1),{hasAccess:l}=(0,i.Z)(),u=n.gateway.supportedCurrencies.length>1&&!r&&l;return(0,s.jsxs)(t.QQ.Root,{children:[(0,s.jsxs)(t.QQ.Header,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(t.QQ.Title,{children:"Currencies"}),(0,s.jsx)(t.QQ.Description,{children:"Decide what currencies are available for this gateway. Transactions outside the selected currencies will be declined."})]}),(0,s.jsx)(t.QQ.HeaderAction,{children:u&&(0,s.jsx)(t.zx,{disabled:!n.isEnabled,onClick:()=>c(!0),variant:"secondary",size:"lg",children:"Edit"})})]}),(0,s.jsxs)(t.QQ.Content,{children:[!r&&(0,s.jsx)(t.Uo,{children:(0,s.jsx)(o,{gateway:n})}),r&&(0,s.jsx)(t.Uo,{children:(0,s.jsx)(b,{closeForm:()=>c(!1),gateway:n})})]})]})}},99863:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return k}});var s=r(70813),t=r(38220),a=r(53164),i=r(31552),c=r(26291),o=r(37013),l=r(18159),u=r(44065),d=r(23851),f=r(83160),x=r(16053),g=r(16016),j=r(94872),h=r(23597);function m(e){var n,r;let{defaultData:a,onCancel:i}=e,c=(0,x.Z)("klarna"),o=(0,j.Z)(),m=(0,t.pm)(),{formState:{isValid:v,isDirty:p,errors:b,isSubmitSuccessful:w},handleSubmit:y,clearErrors:C,getValues:Q,register:Z,setError:P,reset:z}=(0,u.cI)({resolver:(0,l.F)(g.Z),defaultValues:{...a},mode:"onTouched"}),{openUnsavedAlertDialog:k,UnsavedAlert:U}=(0,f.Q)({onDiscard:()=>{z(),i()},shouldConfirmLeave:p&&!w});(0,d.Z)(()=>{v&&o.mutate(Q(),{onError:e=>{let{message:n}=e.data;P("apiPassword",{message:n}),P("apiUsername",{message:n})},onSuccess:()=>{C()}})},500,[v]);let E=y(e=>{c.mutate({region:e.region,apiPassword:e.apiPassword,apiUsername:e.apiUsername},{onSuccess:()=>{m({message:"Gateway successfully updated",variant:"success"}),i()}})});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("form",{onSubmit:E,children:[(0,s.jsx)(t.UP,{...Z("apiUsername"),errorMessage:null===(n=b.apiUsername)||void 0===n?void 0:n.message,id:"klarnaApiUsername",label:"API Username"}),(0,s.jsx)(t.UP,{...Z("apiPassword"),errorMessage:null===(r=b.apiPassword)||void 0===r?void 0:r.message,id:"klarnaApiPassword",label:"API Password"}),(0,s.jsx)(t.mg,{description:"Changing Region is only possible by creating and connecting a new Klarna account.",onValueChange:()=>void 0,options:h.Q,value:null==a?void 0:a.region,label:"Region",disabled:!0}),(0,s.jsxs)(t.QQ.ContentAction,{children:[(0,s.jsx)(t.zx,{onClick:k,disabled:c.isPending,variant:"secondary",type:"button",size:"md",children:"Cancel"}),(0,s.jsx)(t.zx,{$loading:c.isPending,variant:"primary",type:"submit",size:"md",ml:"sm",children:"Save"})]})]}),(0,s.jsx)(U,{})]})}function v(e){let{apiUsername:n,region:r}=e,{hasAccess:a}=(0,o.Z)(),[l,u]=(0,c.Z)(!1);return(0,s.jsxs)(t.QQ.Root,{children:[(0,s.jsxs)(t.QQ.Header,{children:[(0,s.jsx)(t.QQ.Title,{children:"Connection details"}),(0,s.jsx)(t.QQ.HeaderAction,{children:!l&&a&&(0,s.jsx)(t.zx,{onClick:()=>u(!0),variant:"secondary",size:"lg",children:"Edit"})})]}),(0,s.jsxs)(t.QQ.Content,{children:[l&&(0,s.jsx)(t.Uo,{children:(0,s.jsx)(m,{onCancel:()=>u(!1),defaultData:{apiUsername:n,region:r}})}),!l&&(0,s.jsx)(t.Uo,{children:(0,s.jsxs)(t.uG,{children:[(0,s.jsx)(t.xv,{color:"waterloo",children:"API Username"}),(0,s.jsx)(t.xv,{children:n}),(0,s.jsx)(t.xv,{color:"waterloo",children:"API Password"}),(0,s.jsx)(t.xv,{children:"••••••••"}),(0,s.jsx)(t.xv,{color:"waterloo",children:"Region"}),(0,s.jsx)(t.xv,{children:i.cE[r]})]})})]})]})}var p=r(74115),b=r(81244),w=r(91449),y=r(85493),C=r(18208),Q=r(24714),Z=r(75251);let P="klarna",z=()=>{let{data:e,isPending:n,isError:r}=(0,p.Z)(P);return((0,Z.Z)(e,n),n)?(0,s.jsx)(t.Ib,{loading:!0}):r?(0,s.jsx)(t.xu,{width:"fit-content",m:"sm",children:(0,s.jsx)(t.Te,{resource:"gateway"})}):(0,s.jsxs)(y.Z,{leftColumnContent:(0,s.jsx)(w.Z,{slug:P}),gateway:e,children:[(0,s.jsx)(v,{region:null==e?void 0:e.region,apiUsername:null==e?void 0:e.apiUsername}),(0,s.jsx)(b.Z,{gateway:e}),(0,s.jsx)(C.Z,{gateway:e}),(0,s.jsx)(Q.Z,{gateway:e})]})};z.getLayout=e=>(0,s.jsx)(a.Z,{children:e});var k=z},23851:function(e,n,r){"use strict";r.d(n,{Z:function(){return a}});var s=r(55826),t=r(89981);function a(e,n,r){void 0===n&&(n=0),void 0===r&&(r=[]);var a=(0,t.Z)(e,n),i=a[0],c=a[1],o=a[2];return(0,s.useEffect)(o,r),[i,c]}},89981:function(e,n,r){"use strict";r.d(n,{Z:function(){return t}});var s=r(55826);function t(e,n){void 0===n&&(n=0);var r=(0,s.useRef)(!1),t=(0,s.useRef)(),a=(0,s.useRef)(e),i=(0,s.useCallback)(function(){return r.current},[]),c=(0,s.useCallback)(function(){r.current=!1,t.current&&clearTimeout(t.current),t.current=setTimeout(function(){r.current=!0,a.current()},n)},[n]),o=(0,s.useCallback)(function(){r.current=null,t.current&&clearTimeout(t.current)},[]);return(0,s.useEffect)(function(){a.current=e},[e]),(0,s.useEffect)(function(){return c(),o},[n]),[i,o,c]}}},function(e){e.O(0,[6843,3993,2627,5953,8159,7382,9855,3164,3099,4571,626,2756,2403,2888,9774,179],function(){return e(e.s=95952)}),_N_E=e.O()}]);